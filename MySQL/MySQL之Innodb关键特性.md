#MySQL之Innodb关键特性
##insert buffer（在内存中数据结构为B+树）
###辅助索引在MySQL中也是以B+树的形式进行存储，因此当插入行记录时，辅助索引页需要进行插入到索引页中，在操作频繁的插入中，辅助索引的更新也是一件开销特别大的操作，因此当该索引是辅助索引且非唯一时，在插入时，先判断该索引页是否在内存中，若在则直接插入，若不在，放到insert buffer对象中，然后再以一定的频率和情况进行insert buffer 和 辅助索引页子节点的merge操作，通过这种将多个插入合并到一个插入中，避免了频繁的离散读，大大提高了对于辅助索引的插入。
###这里，如果辅助索引是唯一的，那么在插入缓冲时，数据库需要去查找索引树来判断插入记录的唯一性，会有离散读的情况，从而导致insert buffer失去了意义，因此insert buffer机制面向的辅助索引，必须是非唯一的。
##change buffer
###insert buffer的升级版，面向的功能具体是：insert buffer、delete buffer、purge buffer。同样是面对非唯一辅助索引。
##double write
###insert buffer 提供的是性能上的提升，double write提供的就是数据的可靠性，innodb在将脏页写到磁盘的过程中，如果发生了宕机，就会出现某个页只写了一部分的问题，为了保证这种情况不出现，double write机制将脏页刷新到磁盘，进行了步骤拆分，首先将页的信息拷贝到内存中的doublewrite buffer中，之后doublewrite buffer再分两次，每次1MB顺序地写入共享表空间的物理磁盘上（共享表空间中的页相当于一个副本），然后马上调用fsync函数，同步磁盘，避免缓冲写带来的问题。这里写到共享表空间的物理磁盘上，说白了就是为了宕机时，能有一个页的副本，在应用redo log前，对写入失效的页进行恢复，再通过redo log进行重做。这里，如果double write buffer 写到副本过程中宕机是没问题的，因为脏页还没有刷新到磁盘中，可以通过redo log进行重做。
##自适应哈希索引
###innodb根据访问的频率和模式，对缓冲池中的热点页进行建立哈希索引，提高访问速度，但只对单一的访问方式有用，范围查询是无法使用的。
##异步IO
###AIO的一个优势在于，某些情况下innodb可以将多个IO合并为一个IO，这样需要多次磁盘操作，变成了只需一次磁盘IO。
##刷新临近页
###innodb在刷新脏页时，会判断脏页所在的区是否还有脏页，有的话一起刷新，原理同AIO，将多个磁盘IO变成一个磁盘IO，但这样子也有面临着问题，SSD有较高的IOPS，是否还需要这个特性？如果刷新了临近页后，该页很快又有写入，又变成了脏页怎么办？