## 文件是对磁盘的抽象
### 文件
#### 1）文件的命名
#### 2）文件的结构
#### 3）文件的类型
#### 4）文件的访问
#### 5）文件的属性
#### 6）文件的操作

### 目录

### 文件系统的实现
#### 1）文件系统的布局：文件系统存放在磁盘上，多数磁盘划分为一个或多个分区，每一个分区拥有自己独立的文件系统；
![](../resource/操作系统/磁盘文件系统布局.png)

> MBR：Master Boot Record，主引导记录，磁盘的0号扇区，用来引导计算机，在计算机被引导时，MBR被读入BIOS并执行，第一件事就是确定活动分区，接着读入引导块；
> 
> 分区表：记录磁盘每个分区的起始地址和结束地址；
> 
> 引导块：装载该分区中的操作系统。为统一期间，每个分区从一个引导块开始，尽管它可能不包含操作系统；
> 
> 超级块：包含文件系统的所有关键参数，超级块会被读入内存，确定文件系统类型用的魔数、文件系统中块的数量以及其他重要的管理信息；
> 
> 空闲空间管理：位图或者链表的形式给出；
> 
> i节点：以数据结构的形式存在，每文件每一个，说明了文件的方方面面；
> 
> 根目录：存放文件系统目录树的根部；
> 
> 文件和目录：磁盘上除上述区域外的文件和目录；
>

#### 2）文件的实现：

### 文件系统的管理和优化
#### 1）磁盘空间管理
> 1. 合理设置块大小；
> 2. 记录空闲块；
> 3. 磁盘配额；

#### 2）文件系统备份

#### 3）文件系统一致性

#### 4）文件系统性能
> 1. 高速缓存；
> 2. 块提前读；
> 3. 减少磁臂运动；

#### 5）磁盘碎片整理
> 1. 系统启动时，程序和文件的加载在磁盘上井然有序，但随着文件的不断创建和删除，磁盘出现许多碎片区域，当创建一个文件时，文件对应的快可能会散落在整个磁盘上，读写性能降低，因此，整理碎片区域，留出大段连续空闲区，有利于磁盘读写的性能；
> 
> 2. 磁盘碎片整理程序，会在每个分区末端的连续区域内有大量空闲空间的文件系统上很好地运行，这段空间会允许磁盘碎片整理程序选择在分区开始端的碎片文件，并复制它们所有的块放到空闲空间内，这个动作在磁盘开始处释放出一个连续的空间，这样，原始或其它文件可以在其中相邻地存放； 
>
> 3. 机械硬盘通过磁盘碎片整理，提高磁盘读写效率；
> 
> 4. 固态硬盘不受磁盘碎片影响，相反，经常整理磁盘碎片反而会降低固态硬盘的寿命；
> 
> 5. 有些文件不能移动，像页文件、休眠文件、日志等，因为移动它们的收益小于管理它们的成本，在一些系统中，这些文件是固定大小的连续区域，因此它们不需要进行碎片整理；
>  
